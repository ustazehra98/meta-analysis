<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zehra Usta">
<meta name="dcterms.date" content="2024-05-24">

<title>Meta Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MetaAnalysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="MetaAnalysis_files/libs/quarto-html/quarto.js"></script>
<script src="MetaAnalysis_files/libs/quarto-html/popper.min.js"></script>
<script src="MetaAnalysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MetaAnalysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="MetaAnalysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MetaAnalysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MetaAnalysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MetaAnalysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MetaAnalysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Meta Analysis</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Zehra Usta </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 24, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#assignment" id="toc-assignment" class="nav-link active" data-scroll-target="#assignment">ASSIGNMENT</a>
  <ul class="collapse">
  <li><a href="#task-1" id="toc-task-1" class="nav-link" data-scroll-target="#task-1">Task 1</a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2">Task 2</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="assignment" class="level1">
<h1>ASSIGNMENT</h1>
<section id="task-1" class="level2">
<h2 class="anchored" data-anchor-id="task-1">Task 1</h2>
<ol type="1">
<li>Import the data from the <code>data\metaanalysis_data.xlsx</code> file. The data come from the meta-analysis study: <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/icd.2064">Todd et al., 2017 - Sex differences in children’s toy preferences: A systematic review, meta‐regression, and meta‐analysis</a></li>
</ol>
<p>The study looks at various studies of children choosing what kind of toys they play with (stereotypically ‘boy-toys’ or stereotypically ‘girl-toys’). Mean times (in seconds) of playing are recorded, along with sample sizes and standard errors (for boys playing with each kind of toys and for girls playing with each kind of toys).</p>
<p>There’s also information about the studies (e.g.&nbsp;year) and a bit about quality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">'/Users/zehrausta/Desktop/metaanalysis_data.xlsx'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 28
   Study           `Female authors` `Male authors` `Age (months)` N_boys N_girls
   &lt;chr&gt;                      &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1 Alexander &amp; Sa…                2              0           19.5     47      47
 2 Arthur (2014)                  1              0           19       22      18
 3 Berenbaum &amp; Hi…                2              0           65.8     18      18
 4 Berenbaum &amp; Sn…                2              0           93.1     19      19
 5 Doering et al …                1              3           87       15      15
 6 Idle et al. (1…                2              1           46       10      10
 7 Lamminmäki &amp; H…                5              1           14       21      21
 8 Li &amp; Wong (201…                2              0           77       38      38
 9 Pasterski et a…                3              3           81       12      12
10 Pasterski et a…                3              3           81       25      25
# ℹ 17 more rows
# ℹ 22 more variables: Mean_boys_play_male &lt;dbl&gt;, SD_boys_play_male &lt;dbl&gt;,
#   Mean_girls_play_male &lt;dbl&gt;, SD_girls_play_male &lt;dbl&gt;,
#   Mean_boys_play_female &lt;dbl&gt;, SD_boys_play_female &lt;dbl&gt;,
#   Mean_girls_play_female &lt;dbl&gt;, SD_girls_play_female &lt;dbl&gt;,
#   `Neutral toys` &lt;dbl&gt;, Year &lt;dbl&gt;, `Parent present` &lt;dbl&gt;, Setting &lt;dbl&gt;,
#   Country &lt;dbl&gt;, `Case definition adequate` &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Here’s authors’ descriptions to the data:</p>
<blockquote class="blockquote">
<p>Neutral toys (1 = neutral toys included; 2 = neutral toys not included); Parent present (1 = absent; 2 = minimal interaction; 3 = moderate or full interaction); Setting = location of study (1 = home; 2 = laboratory; 3 = nursery); Country = gender inequality index, a measure of how gender egalitarian the country was at the time the study took place.</p>
</blockquote>
<blockquote class="blockquote">
<p>Note. Quality is assessed using Newcastle–Ottawa Quality Assessment Scale criteria adapted for this study. A star indicates that the study fulfilled this criterion; an X indicates that the study did not fulfil this criterion. Case definition adequate: clear justification for the gendered nature of a toy, for example, based on research. Representativeness of cases: recruitment of consecutive participants. Selection of controls: whether boys and girls were comparable in terms of social background. Parental opinion: whether parents’ views on gender were measured. Comparability of both groups: the toys were comparable (in size, shape, etc.) and if the boys and girls were comparable in age. Ascertainment of behaviour: Play behaviour was clearly defined. Same ascertainment method for both groups: The measurement of the outcome (time spent playing with toy) was clearly defined. Nonresponse rate: whether either nonuptake or dropout rates reported.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>meta_girls <span class="ot">&lt;-</span> <span class="fu">metacont</span>(<span class="at">n.e =</span> N_girls, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean.e=</span>Mean_girls_play_male,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd.e=</span>SD_girls_play_male,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.c=</span>N_girls,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean.c=</span>Mean_girls_play_male,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd.c=</span>SD_girls_play_male,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>data)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>meta_boys <span class="ot">&lt;-</span> <span class="fu">metacont</span>(<span class="at">n.e =</span> N_boys, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean.e=</span>Mean_boys_play_male,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd.e=</span>Mean_boys_play_male,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.c=</span>N_boys,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean.c=</span>Mean_boys_play_female,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sd.c=</span>SD_boys_play_female,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>data,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">comb.fixed =</span><span class="cn">FALSE</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">comb.random=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">Task 2</h2>
<ol start="2" type="1">
<li>Experiment using what you’ve learned:</li>
</ol>
<ol type="a">
<li>combine the effects</li>
<li>create a funnel plot (what do you see?)</li>
<li>check if methods / quality affect the results</li>
<li>does author gender affect it?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a forest plot of the meta-analysis results, sorted by treatment effect</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>forest_plot <span class="ot">&lt;-</span> meta_boys <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forest</span>(<span class="at">sortvar =</span> TE)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(forest_plot)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>funnel_plot <span class="ot">&lt;-</span> meta_boys <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">funnel</span>()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(funnel_plot)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(funnel_plot)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>contour_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>contour_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a funnel plot with contour levels and colors</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(meta_boys, <span class="at">contour =</span> contour_levels, <span class="at">col.contour =</span> contour_colors)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to the funnel plot</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bottomright"</span>,                   </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"p &lt; 0.10"</span>, <span class="st">"p &lt; 0.05"</span>, <span class="st">"p &lt; 0.01"</span>), </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"n"</span>,                      </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> contour_colors</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$xlim
[1] -679.4042  679.4042

$addrows.below.overall
[1] 0

$colgap
[1] 2mm

$colgap.left
[1] 2mm

$colgap.right
[1] 2mm

$colgap.studlab
[1] 2mm

$colgap.forest
[1] 2mm

$colgap.forest.left
[1] 2mm

$colgap.forest.right
[1] 2mm

$studlab
 [1] 24 13  7 25 22 19  2 23 16 26 27 17 18  1 21 20 10  8 14 15  9 11  5  6 12
[26]  3  4

$TE.format
 [1] ""         ""         ""         "-42.0000" "-38.5300" "-34.4500"
 [7] "-12.0000" "-6.0000"  "18.0100"  "22.0000"  "24.0000"  "24.3000" 
[13] "35.1000"  "35.1000"  "40.8500"  "61.0000"  "61.4400"  "69.3700" 
[19] "94.9000"  "100.8000" "187.7400" "206.6900" "220.3200" "223.2000"
[25] "230.4000" "252.9000" "256.6000" "264.9600" "291.7500" "457.7900"

$seTE.format
 [1] ""         ""         ""         "19.2354"  "48.0648"  "18.0535" 
 [7] "17.8045"  "23.3238"  "26.0182"  "34.6364"  "16.4012"  "7.6897"  
[13] "7.9239"   "10.0967"  "11.2028"  "19.2622"  "68.6767"  "27.0081" 
[19] "34.1345"  "34.3494"  "36.2747"  "79.2127"  "66.2858"  "71.4277" 
[25] "53.3005"  "67.3866"  "127.7278" "72.8361"  "78.3953"  "113.0706"

$cluster.format
[1] "" "" ""

$effect.format
 [1] ""       "88.85"  ""       "-42.00" "-38.53" "-34.45" "-12.00" "-6.00" 
 [9] "18.01"  "22.00"  "24.00"  "24.30"  "35.10"  "35.10"  "40.85"  "61.00" 
[17] "61.44"  "69.37"  "94.90"  "100.80" "187.74" "206.69" "220.32" "223.20"
[25] "230.40" "252.90" "256.60" "264.96" "291.75" "457.79"

$ci.format
 [1] ""                  "[  49.32; 128.37]" ""                 
 [4] "[ -79.70;  -4.30]" "[-132.74;  55.68]" "[ -69.83;   0.93]"
 [7] "[ -46.90;  22.90]" "[ -51.71;  39.71]" "[ -32.98;  69.00]"
[10] "[ -45.89;  89.89]" "[  -8.15;  56.15]" "[   9.23;  39.37]"
[13] "[  19.57;  50.63]" "[  15.31;  54.89]" "[  18.89;  62.81]"
[16] "[  23.25;  98.75]" "[ -73.16; 196.04]" "[  16.44; 122.30]"
[19] "[  28.00; 161.80]" "[  33.48; 168.12]" "[ 116.64; 258.84]"
[22] "[  51.44; 361.94]" "[  90.40; 350.24]" "[  83.20; 363.20]"
[25] "[ 125.93; 334.87]" "[ 120.82; 384.98]" "[   6.26; 506.94]"
[28] "[ 122.20; 407.72]" "[ 138.10; 445.40]" "[ 236.18; 679.40]"

$effect.ci.format
 [1] ""                         "88.85 [  49.32; 128.37]" 
 [3] ""                         "-42.00 [ -79.70;  -4.30]"
 [5] "-38.53 [-132.74;  55.68]" "-34.45 [ -69.83;   0.93]"
 [7] "-12.00 [ -46.90;  22.90]" "-6.00 [ -51.71;  39.71]" 
 [9] "18.01 [ -32.98;  69.00]"  "22.00 [ -45.89;  89.89]" 
[11] "24.00 [  -8.15;  56.15]"  "24.30 [   9.23;  39.37]" 
[13] "35.10 [  19.57;  50.63]"  "35.10 [  15.31;  54.89]" 
[15] "40.85 [  18.89;  62.81]"  "61.00 [  23.25;  98.75]" 
[17] "61.44 [ -73.16; 196.04]"  "69.37 [  16.44; 122.30]" 
[19] "94.90 [  28.00; 161.80]"  "100.80 [  33.48; 168.12]"
[21] "187.74 [ 116.64; 258.84]" "206.69 [  51.44; 361.94]"
[23] "220.32 [  90.40; 350.24]" "223.20 [  83.20; 363.20]"
[25] "230.40 [ 125.93; 334.87]" "252.90 [ 120.82; 384.98]"
[27] "256.60 [   6.26; 506.94]" "264.96 [ 122.20; 407.72]"
[29] "291.75 [ 138.10; 445.40]" "457.79 [ 236.18; 679.40]"

[[17]]
NULL

[[18]]
NULL

$figheight
  total_height total_rows height_per_row spacing
1            7         35            0.2       1

$leftcols
[1] "col.studlab" "col.n.e"     "col.mean.e"  "col.sd.e"    "col.n.c"    
[6] "col.mean.c"  "col.sd.c"   

$leftlabs
NULL

$rightcols
[1] "col.effect"   "col.ci"       "col.w.random"

$rightlabs
NULL

$xlim
[1] -165.5335  469.2347

$ylim
[1] 127.7278   0.0000

     Length Class  Mode   
xlim 2      -none- numeric
ylim 2      -none- numeric</code></pre>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>meta_girls <span class="sc">%&gt;%</span> <span class="fu">metareg</span>(<span class="sc">~</span> <span class="st">`</span><span class="at">Country</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">Parent present</span><span class="st">`</span><span class="sc">+</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">Age (months)</span><span class="st">`</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 study with NAs omitted from model fitting.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mixed-Effects Model (k = 26; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0 (SE = 21.0105)
tau (square root of estimated tau^2 value):             0
I^2 (residual heterogeneity / unaccounted variability): 0.00%
H^2 (unaccounted variability / sampling variability):   1.00
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity:
QE(df = 21) = 0.0000, p-val = 1.0000

Test of Moderators (coefficients 2:5):
QM(df = 4) = 0.0000, p-val = 1.0000

Model Results:

                  estimate         se    zval    pval       ci.lb      ci.ub    
intrcpt             0.0000  1218.8153  0.0000  1.0000  -2388.8342  2388.8342    
Country             0.0000    38.2365  0.0000  1.0000    -74.9421    74.9421    
`Parent present`    0.0000     5.9531  0.0000  1.0000    -11.6679    11.6679    
Year                0.0000     0.6037  0.0000  1.0000     -1.1833     1.1833    
`Age (months)`      0.0000     0.1237  0.0000  1.0000     -0.2424     0.2424    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>meta_boys <span class="sc">%&gt;%</span> <span class="fu">metareg</span>(<span class="sc">~</span> <span class="st">`</span><span class="at">Country</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">Parent present</span><span class="st">`</span><span class="sc">+</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span><span class="sc">+</span><span class="st">`</span><span class="at">Age (months)</span><span class="st">`</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 study with NAs omitted from model fitting.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mixed-Effects Model (k = 26; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     1152.3038 (SE = 615.6624)
tau (square root of estimated tau^2 value):             33.9456
I^2 (residual heterogeneity / unaccounted variability): 73.26%
H^2 (unaccounted variability / sampling variability):   3.74
R^2 (amount of heterogeneity accounted for):            86.67%

Test for Residual Heterogeneity:
QE(df = 21) = 56.9228, p-val &lt; .0001

Test of Moderators (coefficients 2:5):
QM(df = 4) = 56.1806, p-val &lt; .0001

Model Results:

                    estimate         se     zval    pval      ci.lb       ci.ub 
intrcpt           10074.3035  3666.7784   2.7475  0.0060  2887.5499  17261.0572 
Country             -29.5403   136.4992  -0.2164  0.8287  -297.0739    237.9933 
`Parent present`    -18.7057    18.2287  -1.0262  0.3048   -54.4333     17.0219 
Year                 -4.9986     1.8184  -2.7489  0.0060    -8.5625     -1.4346 
`Age (months)`        2.0485     0.5109   4.0096  &lt;.0001     1.0471      3.0498 
                      
intrcpt            ** 
Country               
`Parent present`      
Year               ** 
`Age (months)`    *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dat.bcg, <span class="at">package =</span> <span class="st">"dataMeta"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in data(dat.bcg, package = "dataMeta"): data set 'dat.bcg' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat.bcg)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct meta-analysis</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>meta_analysis <span class="ot">&lt;-</span> <span class="fu">metabin</span>(<span class="at">event.e =</span> tpos, <span class="at">n.e =</span> tpos <span class="sc">+</span> tneg,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">event.c =</span> cpos, <span class="at">n.c =</span> cpos <span class="sc">+</span> cneg,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> dat.bcg,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">studlab =</span> <span class="fu">paste</span>(author, year),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sm =</span> <span class="st">"RR"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">comb.random =</span> <span class="cn">TRUE</span>, <span class="at">comb.fixed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(meta_analysis)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forest plot</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(meta_analysis)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Subgroup analysis by continent</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>subgroup_analysis <span class="ot">&lt;-</span> <span class="fu">update</span>(meta_analysis, <span class="at">byvar =</span> alloc)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(subgroup_analysis)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forest plot with subgroups</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(subgroup_analysis)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Funnel plot</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="fu">funnel</span>(meta_analysis)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Egger's test for publication bias</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>egger_test <span class="ot">&lt;-</span> <span class="fu">metabias</span>(meta_analysis, <span class="at">method.bias =</span> <span class="st">"linreg"</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(egger_test)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence analysis (leave-one-out)</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>influence_analysis <span class="ot">&lt;-</span> <span class="fu">metainf</span>(meta_analysis)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(influence_analysis)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the influence analysis</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(influence_analysis)        </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  trial               author year tpos  tneg cpos  cneg ablat     alloc
1     1              Aronson 1948    4   119   11   128    44    random
2     2     Ferguson &amp; Simes 1949    6   300   29   274    55    random
3     3      Rosenthal et al 1960    3   228   11   209    42    random
4     4    Hart &amp; Sutherland 1977   62 13536  248 12619    52    random
5     5 Frimodt-Moller et al 1973   33  5036   47  5761    13 alternate
6     6      Stein &amp; Aronson 1953  180  1361  372  1079    44 alternate
                              RR           95%-CI %W(random)
Aronson 1948              0.4109 [0.1343; 1.2574]        5.1
Ferguson &amp; Simes 1949     0.2049 [0.0863; 0.4864]        6.4
Rosenthal et al 1960      0.2597 [0.0734; 0.9186]        4.4
Hart &amp; Sutherland 1977    0.2366 [0.1793; 0.3121]        9.7
Frimodt-Moller et al 1973 0.8045 [0.5163; 1.2536]        8.9
Stein &amp; Aronson 1953      0.4556 [0.3871; 0.5362]       10.1
Vandiviere et al 1973     0.1977 [0.0784; 0.4989]        6.0
TPT Madras 1980           1.0120 [0.8946; 1.1449]       10.2
Coetzee &amp; Berjak 1968     0.6254 [0.3926; 0.9962]        8.7
Rosenthal et al 1961      0.2538 [0.1494; 0.4310]        8.4
Comstock et al 1974       0.7122 [0.5725; 0.8860]        9.9
Comstock &amp; Webster 1969   1.5619 [0.3737; 6.5284]        3.8
Comstock et al 1976       0.9828 [0.5821; 1.6593]        8.4

Number of studies: k = 13
Number of observations: o = 357347 (o.e = 191064, o.c = 166283)
Number of events: e = 2575

                         RR           95%-CI     z  p-value
Random effects model 0.4894 [0.3441; 0.6962] -3.97 &lt; 0.0001

Quantifying heterogeneity:
 tau^2 = 0.3132 [0.1197; 1.1115]; tau = 0.5597 [0.3460; 1.0543]
 I^2 = 92.1% [88.3%; 94.7%]; H = 3.56 [2.93; 4.34]

Test of heterogeneity:
      Q d.f.  p-value
 152.23   12 &lt; 0.0001

Details on meta-analytical method:
- Inverse variance method
- Restricted maximum-likelihood estimator for tau^2
- Q-Profile method for confidence interval of tau^2 and tau
                              RR           95%-CI %W(random)      alloc
Aronson 1948              0.4109 [0.1343; 1.2574]        5.1     random
Ferguson &amp; Simes 1949     0.2049 [0.0863; 0.4864]        6.4     random
Rosenthal et al 1960      0.2597 [0.0734; 0.9186]        4.4     random
Hart &amp; Sutherland 1977    0.2366 [0.1793; 0.3121]        9.7     random
Frimodt-Moller et al 1973 0.8045 [0.5163; 1.2536]        8.9  alternate
Stein &amp; Aronson 1953      0.4556 [0.3871; 0.5362]       10.1  alternate
Vandiviere et al 1973     0.1977 [0.0784; 0.4989]        6.0     random
TPT Madras 1980           1.0120 [0.8946; 1.1449]       10.2     random
Coetzee &amp; Berjak 1968     0.6254 [0.3926; 0.9962]        8.7     random
Rosenthal et al 1961      0.2538 [0.1494; 0.4310]        8.4 systematic
Comstock et al 1974       0.7122 [0.5725; 0.8860]        9.9 systematic
Comstock &amp; Webster 1969   1.5619 [0.3737; 6.5284]        3.8 systematic
Comstock et al 1976       0.9828 [0.5821; 1.6593]        8.4 systematic

Number of studies: k = 13
Number of observations: o = 357347 (o.e = 191064, o.c = 166283)
Number of events: e = 2575

                         RR           95%-CI     z  p-value
Random effects model 0.4894 [0.3441; 0.6962] -3.97 &lt; 0.0001

Quantifying heterogeneity:
 tau^2 = 0.3132 [0.1197; 1.1115]; tau = 0.5597 [0.3460; 1.0543]
 I^2 = 92.1% [88.3%; 94.7%]; H = 3.56 [2.93; 4.34]

Test of heterogeneity:
      Q d.f.  p-value
 152.23   12 &lt; 0.0001

Results for subgroups (random effects model):
                     k     RR           95%-CI  tau^2    tau      Q   I^2
alloc = random       7 0.3787 [0.2205; 0.6504] 0.3925 0.6265 110.21 94.6%
alloc = alternate    2 0.5823 [0.3353; 1.0112] 0.1326 0.3641   5.56 82.0%
alloc = systematic   4 0.6543 [0.3233; 1.3243] 0.4003 0.6327  16.59 81.9%

Test for subgroup differences (random effects model):
                  Q d.f. p-value
Between groups 1.86    2  0.3943

Details on meta-analytical method:
- Inverse variance method
- Restricted maximum-likelihood estimator for tau^2
- Q-Profile method for confidence interval of tau^2 and tau
Linear regression test of funnel plot asymmetry

Test result: t = -1.40, df = 11, p-value = 0.1887
Bias estimate: -2.1120 (SE = 1.5072)

Details:
- multiplicative residual heterogeneity variance (tau^2 = 11.7431)
- predictor: standard error
- weight:    inverse variance
- reference: Egger et al. (1997), BMJ
Influential analysis (random effects model)

                                       RR           95%-CI  p-value   tau^2
Omitting Aronson 1948              0.4931 [0.3398; 0.7155]   0.0002  0.3362
Omitting Ferguson &amp; Simes 1949     0.5199 [0.3649; 0.7409]   0.0003  0.2926
Omitting Rosenthal et al 1960      0.5038 [0.3501; 0.7250]   0.0002  0.3207
Omitting Hart &amp; Sutherland 1977    0.5334 [0.3774; 0.7541]   0.0004  0.2628
Omitting Frimodt-Moller et al 1973 0.4657 [0.3198; 0.6782] &lt; 0.0001  0.3278
Omitting Stein &amp; Aronson 1953      0.4912 [0.3318; 0.7273]   0.0004  0.3596
Omitting Vandiviere et al 1973     0.5193 [0.3646; 0.7397]   0.0003  0.2930
Omitting TPT Madras 1980           0.4517 [0.3175; 0.6426] &lt; 0.0001  0.2732
Omitting Coetzee &amp; Berjak 1968     0.4765 [0.3241; 0.7007]   0.0002  0.3495
Omitting Rosenthal et al 1961      0.5205 [0.3627; 0.7469]   0.0004  0.2987
Omitting Comstock et al 1974       0.4687 [0.3193; 0.6879]   0.0001  0.3405
Omitting Comstock &amp; Webster 1969   0.4678 [0.3274; 0.6684] &lt; 0.0001  0.3082
Omitting Comstock et al 1976       0.4595 [0.3194; 0.6611] &lt; 0.0001  0.3037
                                                                           
Pooled estimate                    0.4894 [0.3441; 0.6962] &lt; 0.0001  0.3132
                                       tau    I^2
Omitting Aronson 1948               0.5798  92.7%
Omitting Ferguson &amp; Simes 1949      0.5409  92.4%
Omitting Rosenthal et al 1960       0.5663  92.7%
Omitting Hart &amp; Sutherland 1977     0.5126  88.6%
Omitting Frimodt-Moller et al 1973  0.5725  92.7%
Omitting Stein &amp; Aronson 1953       0.5996  91.4%
Omitting Vandiviere et al 1973      0.5413  92.5%
Omitting TPT Madras 1980            0.5227  83.8%
Omitting Coetzee &amp; Berjak 1968      0.5911  92.8%
Omitting Rosenthal et al 1961       0.5466  92.1%
Omitting Comstock et al 1974        0.5835  92.7%
Omitting Comstock &amp; Webster 1969    0.5551  92.7%
Omitting Comstock et al 1976        0.5511  92.7%
                                                 
Pooled estimate                     0.5597  92.1%

Details on meta-analytical method:
- Inverse variance method
- Restricted maximum-likelihood estimator for tau^2</code></pre>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="MetaAnalysis_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>